<!DOCTYPE html>
<html>
<head>
<title>Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
<h2>Admin Panel</h2>

<button onclick="shuffle()">Shuffle</button>
<input id="topN" type="number" placeholder="Top N">
<button onclick="makeKO()">Generate Knockout</button>

<div id="matches"></div>
</div>

<script src="supabase.js"></script>
<script src="app.js"></script>
<script>

async function protect(){
 const { data: { user } } = await supabaseClient.auth.getUser();
 if(!user){ location.href="login.html"; return; }

 const { data } = await supabaseClient
   .from("profiles")
   .select("role")
   .eq("id",user.id)
   .single();

 if(!["owner","admin"].includes(data.role)){
   location.href="index.html";
 }
}

protect().then(()=>initAdmin());

</script>

</body>
</html>
